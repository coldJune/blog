---
title: 架构设计师备考
date: 2021-07-22 20:25:44
categories:
    - 软考
copyright: true
tags:
description: 软考备考
---

# 软考备考

![知识点分布](架构设计师备考/知识点分布.png)

## 计算机组成与体系结构

### Flynn分类法

|体系结构类型|结构|关键特性|代表|
|:--:|:--:|:--:|:--:|:--:|
|单指令流单数据流(SISD)|控制部分:一个<br>处理器:一个<br>主存模块:一个||单处理器系统|
|单指令流多数据流(SIMD)|控制部分:一个<br>处理器:多个<br>主存模块:多个|各处理器以异步的形式执行同一条指令|并行处理机<br><font color="red">阵列处理机</font><br>超级向量处理机|
|多指令流单数据流(MISD)|控制部分:多个<br>处理器:一个<br>主存模块:多个|被证明不可能，至少是不实际|目前没有，有文献称流水线计算机为此类|
|多指令多数据流(MIMD)|控制部分:多个<br>处理器:多个<br>主存模块:多个|能够实现作业、任务、指令等各级全面并行|多处理机系统<br>多计算机|

* 阵列处理机：适合数组类的运算，比如二维数组

### CISC与RISC

|指令系统类型|指令|寻址方式|实现方式|其它|
|:--:|:--:|:--:|:--:|:--:|
|CISC(复杂)|数量多，使用频率差别大，可变长格式|支持多种|微程序控制技术(微码)|研制周期长|
|RISC(精简)|数量少，使用频率接近，订长格式，大部分为单周期指令，操作寄存器，只有Load/Store操作内存|支持方式少|增加了通用寄存器；硬布线逻辑控制为主；适合采用流水线|优化编译，有效支持高级语言|

### 流水线

### 存储系统

![层次化存储结构](架构设计师备考/层次化存储结构.png)

#### Cache

> 提高CPU数据输入输出的速率，突破冯·诺伊曼瓶颈，即CPU与存储系统间数据传送贷款的限制

* 在计算机存储系统体系中，Cache是访问速度最快的层次(因寄存器在CPU中，大多数时候未将寄存器放在存储体系中讨论，<front color="red">最快的有寄存器选寄存器，没有选Cache</front>)
* 使用Cache改善性能的依据是程序的局部性原理

如果以$h$代表对Cache的访问命中率，$t_1$表示Cache的周期时间，$t_2$表示主存储器周期时间，以读操作为例，使用“Cache+主存储器”的系统的平均周期为$t_3$，则:
$$t_3=h\times t_1 +(1-h)\times t_2$$
其中，$(1-h)$又称为失效率(未命中率)

#### 局部性原理

* 时间局部性
* 空间局部性
* 工作集理论：工作集是进程运行时被频繁访问的页面集合

#### 主存

##### 分类

* 随机存取存储器:掉电信息丢失
  * DRAM(Dynamic RAM, 动态RAM) -SDRAM
  * SRAM(Static RAM, 静态RAM)


* 只读存储器:掉电信息不丢失
  * MROM(Mask ROM，掩模式ROM)
  * PROM(Programmable ROM，一次可编程ROM)
  * EPROM(Erasable PROM，可擦除的PROM)
  * 闪速存储器(flash memory，闪存)

##### 编址

![主存编制]（架构设计师备考//主存编制.png）

#### 例题
内存地址从AC000H到C7FFFH，共有_K个地址单元，如果该内存地址按字(16bit)编址，由28片存储器芯片构成。已知构成此内存的芯片每片由16K个存储单元，则该芯片每个存储单元存储_位[^1]

#### 磁盘结构与参数
> 存取时间=寻道时间+等待时间(平均定位时间+转动延迟)
*寻道时间指磁头移动到磁道所需的时间；等待时间为等待读写的扇区转到磁头下方所用的时间*

#### 例题
![磁盘例题](架构设计师备考/磁盘例题.png)[^2]
### 校验码
### 并行处理

## 系统配置与性能评价

### 性能指标
* 字长和数据通路宽度
* 主存容量和存取速度
* 运算速度
  * 主频与CPU时钟周期
  * CPI与IPC
  * MIPS与MFLOPS
    > $$MIPS = 指令条数/(执行时间\times 10^6)=主频/CPI=主频\times IPC$$
    > $$MFLOPS = 浮点操作次数/(执行时间\times 10^6)$$

* 吞吐量与吞吐率
* 响应时间与完成时间
* 兼容性
### 阿姆达尔解决方案

对系统中某组件采用某种更快的执行方式，所获得的系统性能的改变程度，取决于该组件被使用的频率，或所占总执行时间的比例。加速比计算公式如下：
$$R=\frac{T_p}{T_i}=\frac{1}{(1-F_e)+F_e/S_e}$$
其中，$T_p$表示不使用改进组件时完成整个任务的时间，$T_i$表示使用改进组件时完成整个任务的时间。
加速比主要取决于两个因素：
* 在原有的系统上，能被改进的部分在总执行时间中所占的比例。这个值称为改进比例，记为$F_e$，它总小于1
* 通过改进的执行方式所取得的性能提高，即如果整个系统使用了改进的执行方式，那么系统的执行速度会有多少提高，这个值等于在原来条件下系统执行时间与使用改进组件后系统的执行时间之比，记为$S_e$，它总大于1

#### 例题

在计算机系统中，某一功能的处理时间为整个系统运行时间的50%，若使该功能的处理速度加快10倍，根据Amdahl定律，这样做可以使整个系统的性能提高_倍。若要使整个系统的性能提高1.5倍，则该功能的处理速度应加快__倍。[^3]

### 性能评价方法
* 时钟频率法
> CPU、片面性极大，早期方式
* 指令执行速度法
> 单位时间执行指令数，片面性大(只衡量加法指令)
* 等效指令速度法(吉普森混合法)
> 每条指令使用概率乘以每条指令执行时间，相当于取平均值，依然局限在运算能力
* 数据处理速率法(PDR)
> 会考虑存储交互性
* 综合理论性能法(CTP)
> 考虑每一个处理部件、计算单元的有效计算率，根据字长调整，比较平衡地取得每个计算单位理论的性能值
* 基准程序法
  * Dhrystone基准程序
  * Linpack基准程序
  * Whetstone基准程序
  * SPEC基准程序(SPECmark、SPECint、SPECfp、SPECrate)
  * TPC基准程序
    * TPC-A：OLTP环境下的数据库和硬件性能
    * TPC-B：不包括网络的纯事务处理，模拟企业计算环境
    * TPC-C：联机订货系统
    * TPC-D、TPC-H、TPC-R：决策支持系统
    * TPC-E：大型企业信息服务系统
    * TPC-W：通过Internet进行市场服务和销售的商业行为

### 性能检测方法

* 软件监控：使用软件对系统性能数据进行采集分析，此方法会消耗较多的系统资源
* 硬件监控：使用专用硬件设备对系统性能进行采集分析，适用于高负载的计算机系统 

## 操作系统基本原理

### 进程管理
* 状态
![进程的状态](架构设计师备考/进程的状态.png)

* 前趋图
![前趋图](架构设计师备考/前趋图.png)
> 考虑哪些有先后，哪些可并行。前趋图描述一系列活动的先后约束关系。

* 同步与互斥
互斥：在同一时刻只允许一个进程使用一个资源
同步：速度有差异，在一定情况下等待
![生产者消费者问题](架构设计师备考/生产者消费者问题.png)

* PV 操作
> 临界资源：诸进程间需要互斥方式对其进行共享的资源，如打印机、磁带机等
> 临界区：每个进程中访问临界资源的那段代码称为临界区
> 信号量：一种特殊的变量(控制临界资源是否能够访问，为1其实就是锁)

![PV操作](架构设计师备考/PV操作.png)

单缓冲区生产者、消费者问题PV原语描述，S1初始值为1，S2初始值为0
```
生产者:
    生产一个产品;
    P(S1);
    送产品到缓冲区;
    V(S2);

消费者:
    P(S2);
    从缓冲区取产品;
    V(S1);
    消费产品;
```
* PV操作与前趋图结合
![PV和前趋图结合](架构设计师备考/PV和前趋图结合.png)

* 死锁问题
>一个进程等待一件不可能发生的事，则进程死锁。如果一个或多个进程产生死锁，就会造成系统死锁
四大条件：环路等待、互斥、保持和等待、不剥夺
死锁的预防：打破四大条件
死锁的避免：有序资源分配法、<front color="red">银行家算法</front>

* 银行家算法
> 当一个进程对资源的最大需求量不超过系统的资源数时可以接纳该进程
> 进程可以分期请求资源，但请求的总数不能超过最大需求量
> 当系统现有的资源不能满足进程尚需资源数时，对进程的请求可以推迟分配，但总能使进程在有限的时间里得到资源

![死锁问题](架构设计师备考/死锁问题.png)
#### 例题
* 例题1[^4]
![PV例题1](架构设计师备考/PV例题1.png)
* 例题2[^5]
![PV例题2](架构设计师备考/PV例题2.png)
* 例题3[^6]
![PV例题3](架构设计师备考/PV例题3.png)
* 例题4[^7]
系统有3个进程，A、B、C。这3个进程都需要5个系统资源。则系统至少有多少个资源不可能发生死锁。
* 例题5[^8]
![银行家算法](架构设计师备考/银行家算法.png)

### 存储管理
#### 页式存储
![页式存储](架构设计师备考/页式存储.png)
* 优点：利用率高，碎片小，分配及管理简单
* 缺点：增加了系统开销(查表)；可能产生抖动现象

#### 段式存储
![段式存储](架构设计师备考/段式存储.png)

#### 段页式存储
![段页式存储](架构设计师备考/段页式存储.png)
* 优点：空间浪费小，存储共享容易，存储保护容易，能动态链接
* 缺点：由于管理软件的增加，复杂性和开销也随之增加，需要的硬件以及占用的内容也有所增加，使得执行速度大大下降

#### 快表
快表是一块小容量的相联存储器(Associative Memory)，由高速缓存器组成，速度快，并且可以从硬件上保证按内容并行查找，一般用来存放当前访问最频繁的少数活动页面的页号。

#### 页面置换算法
* 最优(Optimal,OPT)算法
* 随机(RAND)算法
* <front color="red">先进先出(FIFO)算法</>：有可能产生抖动。例如432143543215序列，用3个页面，比4个缺页要少
![FIFO算法](架构设计师备考/FIFO算法.png)
* <front color="red">最近最少使用(LRU)算法</>：不会抖动
#### 例题
* 例题1[^9]
![页式存储例题](架构设计师备考/页式存储例题.png)
* 例题2[^10]
![页面置换算法例题](架构设计师备考/页面置换算法例题.png)
* 例题3[^11]
![页面置换例题2](架构设计师备考/页面置换例题2.png)

### 文件管理
#### 索引文件结构
![索引文件结构](架构设计师备考/索引文件结构.png)

####  文件系统和树型目录结构
* 文件属性:只读文件属性(R)、存档属性(A)、系统文件(S)、隐藏文件(H)
* 文件名组成:驱动器号、路径、主文件名、扩展名
* <front color="red">绝对路径:是从盘符开始的路径</front>
* <front color="red">相对路径:是从当前路径开始的路径</front>
![树型目录结构](架构设计师备考/树型目录结构.png)
若当前路径为D1，要求F2路径，则绝对路径为：/D1/W2/F2，相对路径：W2/F2

#### 空闲存储空间的管理
* 空闲区表法(空闲文件目录)
* 空闲链表法
* <front color="red">位示图法</front>
* 成组连接法
![位示图法](架构设计师备考/位示图法.png)
#### 例题
* 例题1[^12]
![索引文件结构例题1](架构设计师备考/索引文件结构例题1.png)

* 例题2[^13]
![位示图例题](架构设计师备考/位示图例题.png)

### 设备管理
#### 数据传输控制方式
*  <front color="red">程序控制方式</front>（程序查询方式）：最低级的，CPU介入最多--查询，外设处于被动
*  <front color="red">程序中断方式</front>：外设可以主动触发，效率更高
*  <front color="red">DMA方式</front>(直接存取控制方式)：由专门的DMA控制器控制外设与内存的数据交换
* 通道
* 输入输出处理机

### 微内核操作系统
||实质|优点|缺点|
|:--:|:--:|:--:|:--:|
|单体内核|将图形、设备驱动及文件系统等功能全部在内核中实现，运行在内核状态和同一地址空间|减少进程间通信和状态切换的系统开销，获得较高的运行效率|内核庞大，占用资源较多且不易裁剪<br/>系统的稳定性和安全性不好|
|微内核|只实现基本功能，将图形系统、文件系统、设备驱动及通信功能放在内核之外|内核精炼，便于裁剪和移植<br/>系统服务程序运行在用户地址空间，系统的可靠性、稳定性和安全性较高<br/>可用于分布式系统|用户状态和内核状态需要频繁切换，从而导致系统效率不如单体内核|
![微内核操作系统](架构设计师备考/微内核操作系统.png)
[^1]: 112、4
[^2]: C、B
[^3]: 1.8、3
[^4]: A、C
[^5]: C、A、A
[^6]: D、A、C
[^7]: 13/计算公式：a*(n-1)+1
[^8]: B
[^9]: D、B(访问位为1的不能淘汰，只能淘汰为0的)
[^10]: 12、5、9
[^11]: B、C(指令一次性读入，只产生一次缺页中断，数据跨页产生两次)
[^12]: C、D
[^13]: D($\frac{4195+1}{32}$)、B(第132字第0位置为：4192，第1位置：4193，第2位置：4194，第3位置：4195)，字从1开始算，位置从0开始算